# pllp_RNAseq
RNAseq analysis scripts for 20 dpf EK, pllp pd1116, pllp pd1245 zebrafish larvae.

## Repository Overview

This repository contains the R scripts used for the transcriptomic analysis of *pllp* mutants (EK, pd1116, pd1245) exposed to High Protein (HP) and Low Protein (LP) diets. 
The analysis pipeline is divided into three sequential scripts. They are designed to be run in order, as downstream scripts rely on the output matrices and tables generated by the earlier steps.

### `01_DESeq2_DEGs_and_QC.R`
**Description:** This script performs the primary differential expression analysis, quality control, and overlap visualization.
* **Inputs:** Processed HTSeq count files (`.count`).
* **Processing:**
  * Filters low-count genes and maps Ensembl IDs to Gene Symbols.
  * Normalizes data using DESeq2 (incorporating an interaction model: `~ genotype + diet + genotype:diet`) and performs variance stabilizing transformation (VST).
  * Extracts differentially expressed genes (DEGs) across main effects, condition-specific contrasts, and interaction effects.
  * Identifies unique/overlapping genes across conditions (e.g., potential compensation genes in specific mutants).
* **Outputs:** PCA plots, VST-transformed count matrices, DEG summary tables/bar plots, Venn diagrams, and UpSet plots detailing gene overlaps.

### `02_Enrichment_Pathways.R`
**Description:** Performs comprehensive functional enrichment analysis on the DEGs identified in Step 1.
* **Inputs:** VST normalized counts and DESeq2 significant DEG lists (`.csv` files generated in Step 1).
* **Processing:**
  * Maps Gene Symbols to Entrez IDs.
  * Runs Gene Ontology (GO - Biological Process) and KEGG pathway enrichment using `clusterProfiler`.
  * Utilizes a custom `ggplot2` function to generate highly readable dot plots with text-wrapping and strictly ordered factors.
* **Outputs:** Generates aggregated PDFs of enrichment plots for main effects and dietary comparisons, and exports full GO/KEGG statistical results to CSV format.

### `03_WGCNA_Network_Analysis.R`
**Description:** Performs Weighted Gene Co-expression Network Analysis (WGCNA) to identify modules of highly correlated genes associated with specific genotypes or dietary traits.
* **Inputs:** VST transformed counts and sample metadata (from Step 1).
* **Processing:**
  * Filters the dataset for the top 25% highly variable genes (HVGs) to reduce noise.
  * Selects soft-thresholding powers and constructs a signed hybrid co-expression network.
  * Correlates module eigengenes (MEs) with external traits (Genotype and Diet) and visualizes ME expression across conditions.
  * Performs targeted GO and KEGG enrichment on all identified modules.
  * Runs GSEA (Gene Set Enrichment Analysis) on modules by ranking genes based on their module membership (kME).
  * Uses `compareCluster` to evaluate top enriched KEGG pathways across key modules (e.g., Yellow, Green, Black, Turquoise, Blue, Grey).
* **Outputs:** Module dendrograms, module-trait correlation heatmaps, ME boxplots, module-specific gene lists, and comprehensive module-level GSEA/enrichment plots.

### Software Dependencies

This pipeline was executed using R. To ensure reproducibility, we recommend running these scripts within an RStudio environment.

The following core packages (and their dependencies) are required to run the analysis:

**Bioconductor Packages:**
* `DESeq2` (Differential expression)
* `clusterProfiler` (GO, KEGG, and GSEA)
* `enrichplot` (Enrichment visualizations)
* `org.Dr.eg.db` (Zebrafish annotation database)
* `ComplexHeatmap` (Advanced heatmaps)
* `edgeR` / `limma` (Data manipulation and transformation support)

**CRAN Packages:**
* `tidyverse` (Includes `ggplot2`, `dplyr`, `stringr`, `tibble` for data wrangling/plotting)
* `WGCNA` (Weighted Gene Co-expression Network Analysis)
* `pheatmap` (Standard heatmaps)
* `VennDiagram` & `UpSetR` (Overlap visualizations)
* `ggrepel` (Plot labeling)
* `RColorBrewer` & `circlize` (Color palettes)
* 

### Data Availability

To run these scripts, you will need the raw HTSeq count files (`.count`).

* The raw FASTQ files and the processed count matrices generated during this study are publicly available in the NCBI Gene Expression Omnibus (GEO) under accession number: **[GSExxxxxx: To be determined]**.
